{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ProjectUpsert",
  "type": "object",
  "required": [
    "files",
    "published",
    "title"
  ],
  "properties": {
    "config": {
      "anyOf": [
        {
          "$ref": "#/definitions/Config"
        },
        {
          "type": "null"
        }
      ]
    },
    "description": {
      "type": [
        "string",
        "null"
      ]
    },
    "files": {
      "$ref": "#/definitions/Files"
    },
    "id": {
      "type": [
        "string",
        "null"
      ]
    },
    "layout": {
      "anyOf": [
        {
          "$ref": "#/definitions/Layout"
        },
        {
          "type": "null"
        }
      ]
    },
    "published": {
      "type": "boolean"
    },
    "title": {
      "type": "string",
      "maxLength": 50,
      "minLength": 3
    }
  },
  "definitions": {
    "Config": {
      "type": "object",
      "properties": {
        "limitFps": {
          "default": 0,
          "type": "integer",
          "format": "uint32",
          "minimum": 0.0
        },
        "logLevel": {
          "default": "Info",
          "allOf": [
            {
              "$ref": "#/definitions/LogLevel"
            }
          ]
        },
        "perfLevel": {
          "default": null,
          "anyOf": [
            {
              "$ref": "#/definitions/PerformanceLevel"
            },
            {
              "type": "null"
            }
          ]
        },
        "runner": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "DirNodeState": {
      "type": "object",
      "required": [
        "isRenaming",
        "open"
      ],
      "properties": {
        "isRenaming": {
          "type": "boolean"
        },
        "open": {
          "type": "boolean"
        }
      }
    },
    "File": {
      "description": "Encapsulates all data needed to emulate a file in gputoy virtual directory structure.",
      "type": "object",
      "required": [
        "data",
        "dir",
        "extension",
        "fileName"
      ],
      "properties": {
        "data": {
          "description": "Contents of file in plain text",
          "type": "string"
        },
        "dir": {
          "description": "File path starting at / (project root)",
          "type": "string"
        },
        "extension": {
          "description": "File extension",
          "allOf": [
            {
              "$ref": "#/definitions/SupportedExtension"
            }
          ]
        },
        "fetch": {
          "description": "Fetch url. If exists, then contents will be fetched from remote URL on project load",
          "type": [
            "string",
            "null"
          ]
        },
        "fileName": {
          "description": "Name of file",
          "type": "string"
        }
      }
    },
    "Files": {
      "description": "Gputoy virtual directory. Each file in the map has its path from root as key, including file name and extension\n\nexample: ```ts map: { \"/shaders/main.wgsl\": { \"data\": \"...\", \"dir\": \"shaders/\", \"fileName\": \"main\", \"extension\": \"wgsl\", } } ```",
      "type": "object",
      "required": [
        "map"
      ],
      "properties": {
        "map": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/File"
          }
        }
      }
    },
    "Layout": {
      "type": "object",
      "required": [
        "accordianOpen",
        "fileTreeState",
        "paneSize",
        "paneToggled",
        "workspace"
      ],
      "properties": {
        "accordianOpen": {
          "description": "State of project panel accordians",
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          }
        },
        "fileIndex": {
          "description": "Currently opened file index within workspace",
          "type": [
            "integer",
            "null"
          ],
          "format": "uint",
          "minimum": 0.0
        },
        "fileTreeState": {
          "description": "State of file tree",
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/DirNodeState"
          }
        },
        "paneSize": {
          "description": "Pane size data",
          "allOf": [
            {
              "$ref": "#/definitions/PaneSize"
            }
          ]
        },
        "paneToggled": {
          "description": "Pane toggle data",
          "allOf": [
            {
              "$ref": "#/definitions/PaneToggled"
            }
          ]
        },
        "workspace": {
          "description": "List of file identifiers which is open in workspace. Order of identifiers in vec is the order it is listed in the editor.",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "LogLevel": {
      "type": "string",
      "enum": [
        "Trace",
        "Debug",
        "Info",
        "Warn",
        "Error"
      ]
    },
    "PaneSize": {
      "description": "Pane size information.\n\nPersistent layout data needed to give 'preferred size' to panes.",
      "type": "object",
      "required": [
        "editorPanePercentage",
        "projectPanePx",
        "resourcePanePercentage"
      ],
      "properties": {
        "editorPanePercentage": {
          "description": "What percentage of total window width the editor pane takes up.\n\nIt is assumed the viewport/resource pane will take up the remaining space left behind by the project and editor pane.",
          "type": "number",
          "format": "float"
        },
        "projectPanePx": {
          "description": "How many pixels wide the project pane should be.\n\nWill change its percentage share of the window if window width changes.",
          "type": "integer",
          "format": "uint32",
          "minimum": 0.0
        },
        "resourcePanePercentage": {
          "description": "What percentage of total window height the resource pane takes up.",
          "type": "number",
          "format": "float"
        }
      }
    },
    "PaneToggled": {
      "description": "Pane layout information.",
      "type": "object",
      "required": [
        "editorPane",
        "projectPane",
        "resourcePane"
      ],
      "properties": {
        "editorPane": {
          "description": "Whether the editor pane is open",
          "type": "boolean"
        },
        "projectPane": {
          "description": "Whether the project pane is open",
          "type": "boolean"
        },
        "resourcePane": {
          "description": "Whether the resource pane is open",
          "type": "boolean"
        }
      }
    },
    "PerformanceLevel": {
      "type": "string",
      "enum": [
        "Default",
        "PowerSaver"
      ]
    },
    "SupportedExtension": {
      "type": "string",
      "enum": [
        "wgsl",
        "glsl",
        "txt",
        "md",
        "json",
        "csv",
        "png",
        "jpeg",
        "mp3"
      ]
    }
  }
}